---
title: Armazenar os resultados da verificação de avaliação de vulnerabilidade em uma conta de armazenamento acessível por trás de firewalls e VNets
description: Fornece instruções sobre como armazenar verificações de VA (avaliação de vulnerabilidade) em uma conta de armazenamento que pode ser acessada por meio de um firewall ou de uma VNet
services: sql-database
ms.service: sql-db-mi
ms.subservice: security
ms.topic: conceptual
author: barmichal
ms.author: mibar
ms.reviewer: vanto
ms.date: 04/17/2020
ms.openlocfilehash: 3b1206c4d8a01f38aa0fb145b59ee958914b8205
ms.sourcegitcommit: 93462ccb4dd178ec81115f50455fbad2fa1d79ce
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 07/06/2020
ms.locfileid: "85980666"
---
# <a name="store-vulnerability-assessment-scan-results-in-a-storage-account-accessible-behind-firewalls-and-vnets"></a>Armazenar os resultados da verificação de avaliação de vulnerabilidade em uma conta de armazenamento acessível por trás de firewalls e VNets
[!INCLUDE[appliesto-sqldb-sqlmi](../includes/appliesto-sqldb-sqlmi.md)]

Se você estiver limitando o acesso à sua conta de armazenamento no Azure para determinados VNets ou serviços, você precisará habilitar a configuração apropriada para que a verificação de avaliação de vulnerabilidade (VA) para bancos de dados SQL ou instâncias gerenciadas tenha acesso a essa conta de armazenamento.

## <a name="enable-azure-sql-database-va-scanning-access-to-the-storage-account"></a>Habilitar o acesso de verificação de VA do banco de dados SQL do Azure à conta de armazenamento

Se você tiver configurado sua conta de armazenamento do VA para ser acessível somente por determinadas redes ou serviços, será necessário garantir que as verificações de VA para seu banco de dados SQL do Azure sejam capazes de armazenar as verificações na conta de armazenamento. Para descobrir qual conta de armazenamento está sendo usada, vá para o painel do **SQL Server** na [portal do Azure](https://portal.azure.com), em **segurança**, selecione **segurança de dados avançada**.

:::image type="content" source="media/sql-database-vulnerability-assessment-storage/va-storage.png" alt-text="VA-armazenamento":::

Você pode usar a conta de armazenamento existente ou criar uma nova conta de armazenamento para armazenar os resultados da verificação de VA para todos os bancos de dados em seu [SQL Server lógico](logical-servers.md).

Vá para o **grupo de recursos** que contém a conta de armazenamento e acesse o painel da **conta de armazenamento** . Em **configurações**, selecione **Firewall e redes virtuais**.

Verifique se **a opção permitir acesso de serviços da Microsoft confiável a esta conta de armazenamento** está marcada.

:::image type="content" source="media/sql-database-vulnerability-assessment-storage/storage-allow-microsoft-services.png" alt-text="armazenamento-permitir-Microsoft-serviços":::

## <a name="store-va-scan-results-for-azure-sql-managed-instance-in-a-storage-account-that-can-be-accessed-behind-a-firewall-or-vnet"></a>Armazenar resultados da verificação de VA para o SQL do Azure Instância Gerenciada em uma conta de armazenamento que pode ser acessada por meio de um firewall ou rede virtual

Como Instância Gerenciada não é um serviço confiável da Microsoft e tem uma VNet diferente da conta de armazenamento, a execução de uma verificação de VA resultará em um erro.

Para dar suporte a verificações de VA em instâncias gerenciadas, siga as etapas abaixo:

1. No painel **instância gerenciada do SQL** , no cabeçalho **visão geral** , clique no link **rede virtual/sub-rede** . Isso leva você até o painel de **rede virtual** .

   :::image type="content" source="../managed-instance/media/public-endpoint-configure/mi-overview.png" alt-text="Mi-overview2":::

1. Em **configurações**, selecione **sub-redes**. Clique em **sub-rede** no painel novo para adicionar uma sub-rede e delegá-la para *Microsoft. sql\managedInstance*. Para obter mais informações, consulte [gerenciar sub-redes](../../virtual-network/virtual-network-manage-subnet.md).

   :::image type="content" source="media/sql-database-vulnerability-assessment-storage/mi-subnets.png" alt-text="Mi-sub-redes":::

1. No painel **rede virtual** , em **configurações**, selecione **pontos de extremidade de serviço**. Clique em **Adicionar** no painel novo e adicione o serviço *Microsoft. Storage* como um novo ponto de extremidade de serviço. Verifique se a sub-rede *ManagedInstance* está selecionada. Clique em **Adicionar**.

   :::image type="content" source="media/sql-database-vulnerability-assessment-storage/mi-service-endpoint.png" alt-text="ponto de extremidade de serviço mi":::

1. Vá para sua **conta de armazenamento** que você selecionou para armazenar as verificações de VA. Em **configurações**, selecione **Firewall e redes virtuais**. Clique em **Adicionar rede virtual existente**. Selecione sua rede virtual de instância gerenciada e sub-rede e clique em **Adicionar**.

   :::image type="content" source="media/sql-database-vulnerability-assessment-storage/storage-firewall.png" alt-text="armazenamento-firewall":::

Agora você deve ser capaz de armazenar as verificações de VA para instâncias gerenciadas na sua conta de armazenamento.

## <a name="next-steps"></a>Próximas etapas

- [Avaliação de Vulnerabilidade](sql-vulnerability-assessment.md)
- [Crie uma conta de Armazenamento do Azure](../../storage/common/storage-account-create.md)
- [Segurança de Dados Avançada para Banco de Dados SQL do Azure](advanced-data-security.md)